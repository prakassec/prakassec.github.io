---
title: CSRF
date: 2022-03-30 15:29:00 +/-TTTT
categories: [VAPT, CSRF]
tags: [VAPT]     # TAG names should always be lowercase
---

![CSRF](https://drive.google.com/uc?export=view&id=1km7jI5ygm9O0cDe6grPd5O0VY18wAb6n)  

# CSRF  
Cross Site Request Forgery is an vulnerability which can be easily understood and exploited in the web application.   
And it can be found on most of the sites due to the misconfiguration.  
So most of the peoples in infosec start their learning from this vulnerbility.(which require minimal coding knowledge to exploit it.  

I thought to write a blog aroung it in the perspective of attacker and developer.   
There are various labs available to get a handson exposure on CSRF. Few of them are  

1. https://portswigger.net/web-security/csrf (free)  
2. https://pentesterlab.com/exercises/csrf/course (Paid)  
3. bWAPP(free-offline installation)    


It is recommended to start with the free labs and depend on your interest it can be extended to paid labs or even you can try building a vulnerable web applicaiton on yourself.  

Using CSRF attacker can able to perform actions on behalf of user without their knowledge.    

Consider if you opened a facebook profile in one of the tab and you mistakely clicks or accepts the attacker link.  
Then it is possible for the attacker to change the email address or other sensitive information if the facebook wasnt protected against CSRF.    

Earlier CSRF was found in facebook,google and other big tech guys. Eventhough developers more aware of this exploit in recent days, still misocnfiguration is found by bug hunters.  

## Types    

1. URL based - Sensitive token on GET request    
2. Form based - POST based   

I will start with some of the reports which i found to be interesting related to the CSRF.    

## CSRF in google  
Yeah you heared it right. Even i got wondered how this kind of known bugs is possible in a google platform.  
Like all beginners i had a myth that it will be never possible to exploit Google. Its true their product has unique security team and the developers itself more equipped to build a secure code. But they are still devs right.  


It was report publised by [**Oday Alhalabi**](https://bughunters.google.com/profile/91a2e03b-0b0d-422c-9cd6-aa2a2ae24b57) who is is the top rank in the HOF on google.  
This is the [blog link](https://medium.com/@odayalhalbe1/my-first-bug-in-google-and-how-i-got-csrf-token-for-victim-account-rather-than-bypass-it-1337-bf01261feb47) where he published his report  
He started to bypass the CSRF token in a novel ways but it didnt work out.  
But he found that CSRF token can be viewed by public and that can be sent to victim to exploit it.    

Its a another report by alhalabi itself, where he tried to replace a same length CSRF token in the request and it was accepted due to misconfiguration  
For full [report](https://medium.com/@odayalhalbe1/how-i-earned-500-from-google-by-change-one-character-8350d2b618e50)   

Another one is by [**Jasinder**](https://bughunters.google.com/profile/e20a2905-0b14-4a5b-8a65-b7be9a245807) where he found that bughunters portal having a CSRF token but its not validated against the server.  
Hence it is possible for attacker to read all the reports of the users.   
You can find the more detailed report and video [here](https://jasminderpalsingh.info/csrf-bug-to-access-private-reports-to-google-vrp/)  

Then a clever identification by [**Hassan Khan Yusufzai**](https://bughunters.google.com/profile/9d8d26e4-5295-45b4-85f1-199c6488ca96) on the json data manipulation and results in the CSRF.  
He had a same feeling of mine that google products never be exploited.  




