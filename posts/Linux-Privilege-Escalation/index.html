<!DOCTYPE html><html lang="en" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Linux Privilege Escalation 1" /><meta property="og:locale" content="en" /><meta name="description" content="Security Blog" /><meta property="og:description" content="Security Blog" /><link rel="canonical" href="https://prakassec.github.io//posts/Linux-Privilege-Escalation/" /><meta property="og:url" content="https://prakassec.github.io//posts/Linux-Privilege-Escalation/" /><meta property="og:site_name" content="Prakash Kumar" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-09-14T11:23:00+05:30" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Linux Privilege Escalation 1" /><meta name="twitter:site" content="@prakassec" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-09-14T11:23:00+05:30","datePublished":"2024-09-14T11:23:00+05:30","description":"Security Blog","headline":"Linux Privilege Escalation 1","mainEntityOfPage":{"@type":"WebPage","@id":"https://prakassec.github.io//posts/Linux-Privilege-Escalation/"},"url":"https://prakassec.github.io//posts/Linux-Privilege-Escalation/"}</script><title>Linux Privilege Escalation 1 | Prakash Kumar</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Prakash Kumar"><meta name="application-name" content="Prakash Kumar"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/17383454?s=400&u=ef1657afc2c5278ce80e82d6e1df97a164666094&v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Prakash Kumar</a></div><div class="site-subtitle font-italic">Security Analyst</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/prakassec" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/prakassec" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['hacker0','bugcrowdninja.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Linux Privilege Escalation 1</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Linux Privilege Escalation 1</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Prakash Kumar </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sat, Sep 14, 2024, 11:23 AM +0530" >Sep 14, 2024<i class="unloaded">2024-09-14T11:23:00+05:30</i> </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="437 words">2 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://drive.google.com/thumbnail?id=1nIMK1FDAXIWsP9plB_pYse_LMZOFul7Q&amp;sz=w500" alt="Linux Privilege Escalation" /></p><p><strong>Linux Privilege Escalation</strong></p><p>During an engagement, if we got the access for the low privilege user in the linux environment then it might be necessay to escalate our privilege to other user it might the user having similar access or to a high privilege user to avoid the detection and steathiness.</p><ol><li><p>Vertical Privilege Escalation (Elevation)</p><p>A user with lower privileges (e.g., a regular user) gains higher privileges, such as administrative or root access. This could allow the user to perform system-level actions, modify sensitive files, or access restricted data.</p><li><p>Horizontal Privilege Escalation</p><p>A user accesses another userâ€™s privileges without involving their account in the system logs.</p></ol><p><strong>Common Methods of Privilege Escalation in Linux</strong></p><ol><li>Sudo Misconfigurations<li>SUID/SGID Executables<li>Weak File Permissions<li>Exploiting Crontab Jobs<li>PATH Environment Variable Manipulation<li>NFS Misconfigurations<li>Password Reuse or Weak Credentials<li>Exploit of Service Misconfigurations</ol><p><strong>DEMO TIME</strong></p><p><strong>Exploiting Setuid Programs</strong></p><p>Lets start with a small program which easily allows us to perform the privilege escalaton. Vulnerable setuid programs on Linux systems could lead to privilege escalation attacks. In this exercise, we are using a regular user account and need to escalate the privileges to become root.</p><p><code class="language-plaintext highlighter-rouge">-rwsr-xr-x</code></p><p>First Character (-): This indicates the file type.</p><blockquote><p>- means it is a regular file.<br /> d means it is a directory.<br /> l means it is a symbolic link.</p></blockquote><p>Next Three Characters (rws): These are the owner (user) permissions.</p><blockquote><p>r = read permission for the owner.<br /> w = write permission for the owner.<br /> s = setuid (set user ID) bit, which means that when this file is executed, it runs with the permissions of the fileâ€™s owner (not the person who runs it). This is why itâ€™s s instead of x (execute), as it also sets the user ID.</p></blockquote><p>Next Three Characters (r-x): These are the group permissions.</p><blockquote><p>r = read permission for the group.<br /> - = no write permission for the group.<br /> x = execute permission for the group.</p></blockquote><p>Last Three Characters (r-x): These are the other (world) permissions.</p><blockquote><p>r = read permission for others.<br /> - = no write permission for others.<br /> x = execute permission for others.</p></blockquote><p>From the above concept lets check the following binary <strong>welcome</strong> is having the suid set or not.</p><p><img data-proofer-ignore data-src="https://drive.google.com/thumbnail?id=1Zc8lq44RWPaWCf0LH-tEUGlMg6VJJDDb&amp;sz=w700" alt="Linux Privilege Escalation" /></p><p>Observe that the welcome binary has suid bit set (or on). This means that this binary and its child processes will run with root privileges. Also from the strings analysis we can see that the welcome binary is calling the greeting binary.</p><p><img data-proofer-ignore data-src="https://drive.google.com/thumbnail?id=1HSrZzTWGYohi8qSCSH_qbH0sN7-l3Ds3&amp;sz=w700" alt="Linux Privilege Escalation" /></p><p>Delete greetings binary and then copy /bin/bash to its location and rename that to greetings.</p><p><img data-proofer-ignore data-src="https://drive.google.com/thumbnail?id=1wlJ0qG5nk5DvWe-KQiOKuoBMLMY4FZRR&amp;sz=w700" alt="Linux Privilege Escalation" /></p><p>By using this method we escalated the user account to root in the linux machine.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vapt/'>VAPT</a>, <a href='/categories/privilege-escalation/'>Privilege escalation</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/vapt/" class="post-tag no-text-decoration" >vapt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Linux Privilege Escalation 1 - Prakash Kumar&url=https://prakassec.github.io//posts/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Linux Privilege Escalation 1 - Prakash Kumar&u=https://prakassec.github.io//posts/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Linux Privilege Escalation 1 - Prakash Kumar&url=https://prakassec.github.io//posts/Linux-Privilege-Escalation/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Emotet/">Emotet</a><li><a href="/posts/CVE-2024-10924/">Really Simple Security? More like Really Simple Hacking!(CVE-2024-10924)</a><li><a href="/posts/Azure-Powershell/">Azure Powershell</a><li><a href="/posts/Static-Analysis-with-WinDbg-and-IDA/">Static Analysis with WinDbg and IDA</a><li><a href="/posts/Reverse-Engineering-1/">Reverse Engineering 1</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/vapt/">vapt</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/soc/">soc</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/others/">others</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/WIFI-Security-3-Honeypot/"><div class="card-body"> <span class="timeago small" >Sep 12, 2024<i class="unloaded">2024-09-12T13:34:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WIFI Security 3 - Honeypot</h3><div class="text-muted small"><p> WEP honeypot Its type of decoy wireless network designed to attract and detect malicious activities, typically targeting attackers who exploit weak security protocols. Since the WEP is an vulner...</p></div></div></a></div><div class="card"> <a href="/posts/WIFI-Security-4-Pivoting/"><div class="card-body"> <span class="timeago small" >Sep 26, 2024<i class="unloaded">2024-09-26T11:27:00+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>WIFI Security 4 - Pivoting</h3><div class="text-muted small"><p> Your Red Team has been tasked by Xcorp to conduct a security assessment of their headquarters. Your specific responsibility is to evaluate the security of their WiFi network, which could provide ac...</p></div></div></a></div><div class="card"> <a href="/posts/Burp-suite-configuration/"><div class="card-body"> <span class="timeago small" >May 5, 2019<i class="unloaded">2019-05-05T17:46:12+05:30</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Burp suite configuration</h3><div class="text-muted small"><p> Getting started with Burp suite Burp suite is a tool which is used in penetration testing. It contains collection of tools used to analyse a web application. Before installing Burp into your machi...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/WIFI-Security-3-Honeypot/" class="btn btn-outline-primary" prompt="Older"><p>WIFI Security 3 - Honeypot</p></a> <a href="/posts/Reverse-Engineering-1/" class="btn btn-outline-primary" prompt="Newer"><p>Reverse Engineering 1</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://twitter.com/prakassec">Prakash Kumar</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/vapt/">vapt</a> <a class="post-tag" href="/tags/malware/">malware</a> <a class="post-tag" href="/tags/linux/">linux</a> <a class="post-tag" href="/tags/automation/">automation</a> <a class="post-tag" href="/tags/soc/">soc</a> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/general/">general</a> <a class="post-tag" href="/tags/others/">others</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
